-- TAMBAHKAN PARAMETER UNTUK PEMBATASAN SRR YANG MENDAPATKAN BAGI HASIL
insert Parameter (Numeric_Value, Key_Parameter)
values (50000.0, 'MINIMAL_SRR_BAGI_HASIL');

DROP INDEX [TRANSAKSIDPLK].[IX_HITSRRTRANSPST];

CREATE NONCLUSTERED INDEX [IX_HITSRRTRANSPST] ON [TRANSAKSIDPLK] 
([ISCOMMITTED] ASC, [NO_PESERTA] ASC, [TGL_TRANSAKSI] ASC, [MUTASI_IURAN_PK] ASC, [MUTASI_IURAN_PST] ASC, [MUTASI_PENGEMBANGAN] ASC, [MUTASI_PERALIHAN] ASC);

DROP INDEX [REKENINGDPLK].[IX_STATUS_DPLK];

CREATE NONCLUSTERED INDEX [IX_STATUS_DPLK] ON [REKENINGDPLK] 
([NO_PESERTA] ASC, [STATUS_DPLK] ASC, [KODE_PAKET_INVESTASI] ASC);

/*
-- CONTOH SKRIP UNTUK MENGUPDATE TGL_REGISTRASI (TIDAK WAJIB DIEKSEKUSI)
-- SET TANGGAL REGISTRASI SESUAI DENGAN TANGGAL TRANSAKSI PALING MUDA
-- KHUSUS PESERTA YANG MEMILIKI TRANSAKSI YANG LEBIH MUDA DARI TGL_REGISTRASINYA

update NasabahDPLK
set tgl_registrasi =
  (select min(tgl_transaksi)
  from TransaksiDPLK
  where NasabahDPLK.no_peserta = TransaksiDPLK.no_peserta
    and tgl_transaksi is not null)
from NasabahDPLK, TransaksiDPLK
where NasabahDPLK.no_peserta = TransaksiDPLK.no_peserta
  and tgl_registrasi > tgl_transaksi;
*/
